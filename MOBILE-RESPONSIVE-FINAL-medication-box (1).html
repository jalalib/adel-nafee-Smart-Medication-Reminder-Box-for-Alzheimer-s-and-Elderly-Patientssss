<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Medication Box - Interactive Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background: #f5f7fa;
        }
        
        /* Mobile-first responsive timer */
        #timer-display {
            position: fixed;
            top: 10px;
            right: 10px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
            padding: 12px 16px;
            z-index: 9998;
            border: 3px solid #3b82f6;
            max-width: 140px;
        }
        
        @media (min-width: 768px) {
            #timer-display {
                top: 20px;
                right: 20px;
                border-radius: 16px;
                padding: 20px 24px;
                max-width: 200px;
                border: 4px solid #3b82f6;
            }
        }
        
        /* Ensure modals work on small screens */
        .modal-content {
            max-height: 90vh;
            overflow-y: auto;
        }
        
        /* Better touch targets for mobile */
        button {
            min-height: 44px;
        }
        
        @media (max-width: 640px) {
            .phone-mockup {
                max-width: 280px;
            }
        }
        
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
        }
        
        .gradient-button {
            background: linear-gradient(135deg, #667eea 0%, #4fd1c5 100%);
            transition: transform 0.2s;
        }
        
        .gradient-button:hover {
            transform: translateY(-2px);
        }
        
        .phone-mockup {
            background: linear-gradient(145deg, #1f2937, #111827);
            border-radius: 40px;
            padding: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .notification-enter {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        .compartment-card {
            border: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .compartment-open {
            border-color: #fbbf24;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
        }
        
        #page-home, #page-demo {
            min-height: 100vh;
        }
        
        .hidden-page {
            display: none;
        }
    </style>
</head>
<body>
    <!-- HOME PAGE -->
    <div id="page-home" class="py-12 px-4">
        <div class="max-w-6xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-12">
                <div class="inline-block p-4 bg-blue-100 rounded-full mb-4">
                    <svg class="w-12 h-12 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
                    </svg>
                </div>
                <h1 class="text-5xl font-bold text-gray-900 mb-4">Smart Medication Box</h1>
                <p class="text-xl text-gray-600 mb-8">An innovative solution to help Alzheimer's patients and elderly people manage their<br>medications safely and effectively</p>
                <button onclick="startDemo()" class="gradient-button text-white px-8 py-4 rounded-full font-semibold text-lg shadow-lg">
                    Start Interactive Demo
                </button>
            </div>

            <!-- The Problem -->
            <div class="card p-8 mb-6">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900 mb-3">The Problem</h2>
                        <p class="text-gray-600 leading-relaxed">Alzheimer's patients face significant challenges in adhering to correct medication schedules. Even with colored smart pill boxes, they struggle with forgetting doses and mixing up different medications, which poses a direct threat to their health and safety.</p>
                    </div>
                </div>
            </div>

            <!-- Our Solution -->
            <div class="card p-8 mb-6">
                <div class="flex items-start gap-4">
                    <div class="flex-shrink-0 w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900 mb-3">Our Solution</h2>
                        <p class="text-gray-600 leading-relaxed">A smart medication box that opens only the correct medication at the scheduled time, with clear audio alerts and sensors to verify medication intake. This reduces errors, improves adherence, and provides peace of mind for families.</p>
                    </div>
                </div>
            </div>

            <!-- Features -->
            <div class="grid md:grid-cols-3 gap-6 mb-6">
                <div class="card p-6">
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mb-4">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 mb-2">Automated Timing</h3>
                    <p class="text-sm text-gray-600">Opens the correct compartment automatically at the scheduled medication time</p>
                </div>

                <div class="card p-6">
                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mb-4">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 mb-2">Smart Sensors</h3>
                    <p class="text-sm text-gray-600">Touch and weight sensors verify that medication has been taken correctly</p>
                </div>

                <div class="card p-6">
                    <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mb-4">
                        <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 mb-2">Family Alerts</h3>
                    <p class="text-sm text-gray-600">Instant notifications to family members if medication is missed or delayed</p>
                </div>
            </div>

            <!-- Hypothesis -->
            <div class="card p-8 mb-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Hypothesis</h2>
                <p class="text-gray-700 mb-2"><span class="font-semibold">Primary Hypothesis:</span> If we design a smart medication box that opens only the correct medication at its scheduled time, with clear audio alerts and sensors to verify intake, then the patient's adherence rate will increase and the likelihood of forgetting or mixing medications will decrease.</p>
            </div>

            <!-- Materials -->
            <div class="card p-8 mb-12">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Materials & Components</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                        <span class="text-gray-700">Control Board (Arduino)</span>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                        <span class="text-gray-700">Weight Sensor</span>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                        <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
                        <span class="text-gray-700">Touch Sensor</span>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                        <div class="w-2 h-2 bg-pink-500 rounded-full"></div>
                        <span class="text-gray-700">Small Motors</span>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                        <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                        <span class="text-gray-700">Audio Module</span>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                        <div class="w-2 h-2 bg-red-500 rounded-full"></div>
                        <span class="text-gray-700">Rechargeable Battery</span>
                    </div>
                </div>
            </div>

            <!-- CTA -->
            <div class="text-center">
                <button onclick="startDemo()" class="gradient-button text-white px-12 py-5 rounded-full font-bold text-xl shadow-xl">
                    Experience the Interactive Demo
                </button>
            </div>

            <!-- Footer -->
            <div class="text-center mt-12 text-sm text-gray-500">
                <p>🏆 Science Olympiad 2025 - موهبة | Adel Nafee | Awf bin Al-Harith School</p>
            </div>
        </div>
    </div>

    <!-- DEMO PAGE -->
    <div id="page-demo" class="hidden-page py-8 px-4">
        <div class="max-w-7xl mx-auto">
            <!-- Back Button -->
            <button onclick="backToHome()" class="mb-6 flex items-center gap-2 text-gray-600 hover:text-gray-900 font-semibold">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                </svg>
                Back to Home
            </button>

            <!-- Title -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-900 mb-2">Interactive Simulation</h1>
                <p class="text-gray-600">Experience the complete medication reminder flow step by step</p>
            </div>

            <!-- Timeline -->
            <div class="card p-6 mb-8">
                <div class="flex items-center justify-around">
                    <div class="text-center">
                        <div class="w-16 h-16 mx-auto bg-blue-100 rounded-full flex items-center justify-center mb-2">
                            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <p class="text-xs font-semibold text-gray-600">Select Time</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 mx-auto bg-yellow-100 rounded-full flex items-center justify-center mb-2">
                            <svg class="w-8 h-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                            </svg>
                        </div>
                        <p class="text-xs font-semibold text-gray-600">Medicine Alert</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 mx-auto bg-orange-100 rounded-full flex items-center justify-center mb-2">
                            <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <p class="text-xs font-semibold text-gray-600">Reminder (20s)</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-2">
                            <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                            </svg>
                        </div>
                        <p class="text-xs font-semibold text-gray-600">Urgent (40s)</p>
                    </div>
                </div>
            </div>

            <!-- Time Selection -->
            <div class="card p-6 mb-8">
                <div class="flex items-center justify-center gap-4">
                    <select id="time-select" class="px-6 py-3 border-2 border-gray-300 rounded-lg font-semibold text-gray-700">
                        <option value="08:00">08:00 - Blood Pressure Medicine</option>
                        <option value="14:00">14:00 - Diabetes Medicine</option>
                        <option value="20:00">20:00 - Vitamins</option>
                    </select>
                    <button onclick="startSimulation()" id="start-btn" class="gradient-button text-white px-8 py-3 rounded-lg font-semibold flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Start Simulation
                    </button>
                </div>
            </div>

            <!-- Main Demo Area -->
            <div class="grid lg:grid-cols-2 gap-8 mb-8">
                <!-- Medication Box -->
                <div class="card p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Smart Medication Box - 3D View</h2>
                    
                    <!-- Morning Compartment -->
                    <div id="morning-compartment" class="compartment-card bg-gradient-to-r from-yellow-50 to-orange-50 p-6 rounded-xl mb-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="w-14 h-14 bg-yellow-400 rounded-xl flex items-center justify-center">
                                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
                                    </svg>
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold text-gray-900">Morning</h3>
                                    <p class="text-sm text-gray-600">Morning Medication</p>
                                </div>
                            </div>
                            <span id="morning-status" class="text-sm font-semibold text-gray-500 bg-white px-4 py-2 rounded-full">CLOSED</span>
                        </div>
                        <div id="morning-alert" class="hidden mt-4 p-4 bg-yellow-100 border-2 border-yellow-300 rounded-lg">
                            <p class="text-sm font-semibold text-yellow-800 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                                </svg>
                                Alert: Time to take your medication!
                            </p>
                        </div>
                    </div>

                    <!-- Afternoon Compartment -->
                    <div id="afternoon-compartment" class="compartment-card bg-gradient-to-r from-blue-50 to-cyan-50 p-6 rounded-xl mb-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="w-14 h-14 bg-blue-400 rounded-xl flex items-center justify-center">
                                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"/>
                                    </svg>
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold text-gray-900">Afternoon</h3>
                                    <p class="text-sm text-gray-600">Afternoon Medication</p>
                                </div>
                            </div>
                            <span id="afternoon-status" class="text-sm font-semibold text-gray-500 bg-white px-4 py-2 rounded-full">CLOSED</span>
                        </div>
                    </div>

                    <!-- Evening Compartment -->
                    <div id="evening-compartment" class="compartment-card bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-xl mb-6">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="w-14 h-14 bg-purple-400 rounded-xl flex items-center justify-center">
                                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
                                    </svg>
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold text-gray-900">Evening</h3>
                                    <p class="text-sm text-gray-600">Evening Medication</p>
                                </div>
                            </div>
                            <span id="evening-status" class="text-sm font-semibold text-gray-500 bg-white px-4 py-2 rounded-full">CLOSED</span>
                        </div>
                    </div>

                    <!-- Sensors -->
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="p-4 bg-gray-50 rounded-lg">
                            <div class="flex items-center gap-2 mb-2">
                                <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/>
                                </svg>
                                <span class="text-sm font-semibold text-gray-700">Touch Sensor</span>
                            </div>
                            <p id="touch-status" class="text-xs text-gray-500">Waiting for touch...</p>
                        </div>
                        <div class="p-4 bg-gray-50 rounded-lg">
                            <div class="flex items-center gap-2 mb-2">
                                <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"/>
                                </svg>
                                <span class="text-sm font-semibold text-gray-700">Weight Sensor</span>
                            </div>
                            <p id="weight-status" class="text-xs text-gray-500">Monitoring weight...</p>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="touchBox()" class="bg-blue-500 hover:bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold flex items-center justify-center gap-2 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/>
                            </svg>
                            Touch Box
                        </button>
                        <button onclick="takeMedicine()" class="bg-green-500 hover:bg-green-600 text-white py-3 px-6 rounded-lg font-semibold flex items-center justify-center gap-2 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            Take Medicine
                        </button>
                    </div>
                </div>

                <!-- Family Phone -->
                <div class="card p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-3">
                        <svg class="w-7 h-7 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                        </svg>
                        Family Phone - Real-time Updates
                    </h2>

                    <div class="relative">
                        <div id="urgent-badge" class="hidden absolute -top-2 -right-2 z-10">
                            <div class="relative">
                                <div class="absolute inset-0 bg-red-500 rounded-full animate-ping opacity-75"></div>
                                <div class="relative bg-red-500 text-white rounded-full px-3 py-1 text-xs font-bold">URGENT</div>
                            </div>
                        </div>

                        <!-- Phone Mockup -->
                        <div class="phone-mockup max-w-sm mx-auto">
                            <div class="bg-white rounded-3xl overflow-hidden">
                                <!-- Status Bar -->
                                <div class="bg-gray-100 px-4 py-2 flex justify-between items-center text-xs">
                                    <span class="font-semibold">9:41</span>
                                    <div class="flex gap-1">
                                        <div class="w-4 h-3 bg-gray-400 rounded-sm"></div>
                                        <div class="w-4 h-3 bg-gray-400 rounded-sm"></div>
                                        <div class="w-4 h-3 bg-green-500 rounded-sm"></div>
                                    </div>
                                </div>

                                <!-- Notifications -->
                                <div id="phone-notifications" class="p-4 h-96 overflow-y-auto bg-gray-50">
                                    <div class="text-center py-12">
                                        <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                                        </svg>
                                        <p class="text-gray-500 text-sm font-semibold">Ready to receive notifications</p>
                                        <p class="text-gray-400 text-xs mt-2">All medication events will appear here</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Home Button -->
                            <div class="absolute bottom-2 left-1/2 transform -translate-x-1/2 w-12 h-12 bg-gray-800 rounded-full border-2 border-gray-600"></div>
                        </div>
                    </div>

                    <!-- Info Card -->
                    <div class="mt-6 p-4 bg-purple-50 rounded-xl border-2 border-purple-200">
                        <h3 class="text-sm font-semibold text-purple-800 mb-2 flex items-center gap-2">
                            📡 Family Monitoring System
                        </h3>
                        <p class="text-xs text-purple-700">Family receives instant updates for every action: medication time, patient interaction, medicine taken, delays, and urgent alerts.</p>
                    </div>
                </div>
            </div>

            <!-- Future Enhancements -->
            <div class="card p-8">
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center">
                        <svg class="w-7 h-7 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900">Future Enhancements</h2>
                        <p class="text-sm text-gray-600">Click on each feature to explore interactive demonstrations</p>
                    </div>
                </div>

                <div class="grid md:grid-cols-3 gap-6">
                    <!-- Biometric -->
                    <div class="p-6 bg-gradient-to-br from-pink-50 to-red-50 rounded-xl border-2 border-pink-200">
                        <div class="w-12 h-12 bg-pink-500 rounded-lg flex items-center justify-center mb-4">
                            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                            </svg>
                        </div>
                        <h3 class="text-lg font-bold text-gray-900 mb-2">Biometric Health Sensors</h3>
                        <p class="text-sm text-gray-600 mb-4">Integrate sensors to monitor heart rate, blood pressure, and oxygen levels in real time.</p>
                        <button onclick="toggleDemo('biometric')" class="w-full bg-gradient-to-r from-pink-500 to-pink-600 text-white py-2 px-4 rounded-lg font-semibold hover:from-pink-600 hover:to-pink-700 transition-all">
                            <span id="btn-biometric">View Demo</span>
                        </button>
                    </div>

                    <!-- Cloud EHR -->
                    <div class="p-6 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl border-2 border-blue-200">
                        <div class="w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center mb-4">
                            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"/>
                            </svg>
                        </div>
                        <h3 class="text-lg font-bold text-gray-900 mb-2">Cloud-Based EHR Integration</h3>
                        <p class="text-sm text-gray-600 mb-4">Connect to Electronic Health Records for automatic documentation and remote physician monitoring.</p>
                        <button onclick="toggleDemo('ehr')" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-2 px-4 rounded-lg font-semibold hover:from-blue-600 hover:to-blue-700 transition-all">
                            <span id="btn-ehr">View Demo</span>
                        </button>
                    </div>

                    <!-- AI Recognition -->
                    <div class="p-6 bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl border-2 border-purple-200">
                        <div class="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center mb-4">
                            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                            </svg>
                        </div>
                        <h3 class="text-lg font-bold text-gray-900 mb-2">AI Pattern Recognition</h3>
                        <p class="text-sm text-gray-600 mb-4">Apply Artificial Intelligence to predict non-adherence patterns and detect health complications early.</p>
                        <button onclick="toggleDemo('ai')" class="w-full bg-gradient-to-r from-purple-500 to-purple-600 text-white py-2 px-4 rounded-lg font-semibold hover:from-purple-600 hover:to-purple-700 transition-all">
                            <span id="btn-ai">View Demo</span>
                        </button>
                    </div>
                </div>

                <!-- Biometric Demo Content -->
                <div id="demo-biometric" class="hidden mt-8 p-8 bg-gradient-to-br from-pink-50 to-red-50 rounded-2xl border-2 border-pink-300">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">Biometric Health Sensors - Interactive Demo</h3>
                    <p class="text-gray-700 mb-6"><strong>Key Features:</strong></p>
                    <ul class="space-y-2 mb-6">
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Real-time heart rate monitoring</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Blood pressure measurement before medication</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Oxygen saturation (SpO2) tracking</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Smart lock prevents medication during dangerous health conditions</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Immediate caregiver alerts for health emergencies</li>
                    </ul>

                    <!-- Health Metrics -->
                    <div class="grid md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <div class="flex items-center gap-2 text-red-500 mb-2">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>
                                <span class="font-semibold text-gray-700">Heart Rate</span>
                            </div>
                            <p class="text-4xl font-bold text-red-600" id="heart-rate">72 BPM</p>
                            <p class="text-xs text-gray-500 mt-1">✓ Normal</p>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <div class="flex items-center gap-2 text-blue-500 mb-2">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                                <span class="font-semibold text-gray-700">Blood Pressure</span>
                            </div>
                            <p class="text-4xl font-bold text-blue-600" id="blood-pressure">120/80</p>
                            <p class="text-xs text-gray-500 mt-1" id="bp-status">✓ Normal</p>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <div class="flex items-center gap-2 text-cyan-500 mb-2">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"/></svg>
                                <span class="font-semibold text-gray-700">Oxygen (SpO2)</span>
                            </div>
                            <p class="text-4xl font-bold text-cyan-600" id="oxygen">98%</p>
                            <p class="text-xs text-gray-500 mt-1">✓ Normal</p>
                        </div>
                    </div>

                    <!-- BP Simulator with Sliders -->
                    <div class="bg-white p-6 rounded-xl shadow-md mb-4">
                        <h4 class="text-lg font-bold text-gray-800 mb-4">🩺 Simulate Blood Pressure</h4>
                        
                        <div class="mb-6">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Systolic (Upper): <span id="systolic-value" class="text-blue-600">120</span> mmHg</label>
                            <input type="range" id="systolic-slider" min="80" max="200" value="120" 
                                   class="w-full h-3 bg-pink-200 rounded-lg appearance-none cursor-pointer"
                                   oninput="updateBP()"
                                   style="accent-color: #3b82f6;">
                        </div>

                        <div class="mb-4">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Diastolic (Lower): <span id="diastolic-value" class="text-blue-600">80</span> mmHg</label>
                            <input type="range" id="diastolic-slider" min="40" max="130" value="80" 
                                   class="w-full h-3 bg-pink-200 rounded-lg appearance-none cursor-pointer"
                                   oninput="updateBP()"
                                   style="accent-color: #3b82f6;">
                        </div>

                        <div class="p-4 bg-blue-50 border-2 border-blue-200 rounded-lg">
                            <p class="text-sm font-semibold text-blue-700">📊 Current Reading:</p>
                            <p class="text-3xl font-bold text-blue-600 mt-1"><span id="current-systolic">120</span> / <span id="current-diastolic">80</span></p>
                        </div>
                    </div>

                    <!-- Status Messages -->
                    <div id="bp-safe" class="p-4 bg-green-100 border-2 border-green-300 rounded-xl">
                        <div class="flex items-center gap-2">
                            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                            <p class="font-semibold text-green-800">Safe to Take Medication</p>
                        </div>
                        <p class="text-sm text-green-700 mt-1">All vital signs are within normal range</p>
                    </div>

                    <div id="bp-danger" class="hidden p-4 bg-red-100 border-2 border-red-400 rounded-xl">
                        <div class="flex items-center gap-2">
                            <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
                            <p class="font-semibold text-red-800">Example: High Blood Pressure Detected</p>
                        </div>
                        <p class="text-sm text-red-700 mt-1">Medication blocked • Caregiver alerted immediately</p>
                    </div>
                </div>

                <!-- EHR Demo Content -->
                <div id="demo-ehr" class="hidden mt-8 p-8 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl border-2 border-blue-300">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">Cloud-Based EHR Integration - Interactive Demo</h3>
                    <p class="text-gray-700 mb-6"><strong>Key Features:</strong></p>
                    <ul class="space-y-2 mb-6">
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Automatic sync with hospital EHR systems</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Real-time data sharing with physicians</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Medication history tracking</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Remote prescription updates</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> HIPAA-compliant secure cloud storage</li>
                    </ul>

                    <div class="bg-white p-6 rounded-xl shadow-md">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center">
                                <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"/></svg>
                            </div>
                            <div>
                                <p class="font-bold text-gray-900">Connected to Cloud EHR</p>
                                <p class="text-sm text-gray-600">Syncing with hospital database...</p>
                            </div>
                        </div>

                        <div class="space-y-3">
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="text-sm font-semibold text-gray-700">Patient Records</span>
                                <span class="text-xs text-green-600 font-bold">✓ Synced</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="text-sm font-semibold text-gray-700">Medication History</span>
                                <span class="text-xs text-green-600 font-bold">✓ Updated</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="text-sm font-semibold text-gray-700">Physician Access</span>
                                <span class="text-xs text-green-600 font-bold">✓ Active</span>
                            </div>
                        </div>

                        <div class="mt-4 p-4 bg-blue-50 border-2 border-blue-200 rounded-lg">
                            <p class="text-sm font-semibold text-blue-800 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
                                Automatic Documentation
                            </p>
                            <p class="text-xs text-blue-700 mt-1">Every medication intake is automatically recorded in the patient's electronic health record, accessible to authorized physicians for remote monitoring and care coordination.</p>
                        </div>
                    </div>
                </div>

                <!-- AI Demo Content -->
                <div id="demo-ai" class="hidden mt-8 p-8 bg-gradient-to-br from-purple-50 to-indigo-50 rounded-2xl border-2 border-purple-300">
                    <h3 class="text-2xl font-bold text-gray-900 mb-4">AI Pattern Recognition - Interactive Demo</h3>
                    <p class="text-gray-700 mb-6"><strong>Key Features:</strong></p>
                    <ul class="space-y-2 mb-6">
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Machine learning predicts missed doses before they happen</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Analyzes behavioral patterns over time</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Early detection of cognitive decline</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Personalized reminder strategies</li>
                        <li class="flex items-start gap-2"><span class="text-green-500">✓</span> Anomaly detection for health emergencies</li>
                    </ul>

                    <div class="bg-white p-6 rounded-xl shadow-md mb-4">
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center">
                                <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>
                            </div>
                            <div>
                                <p class="font-bold text-gray-900">AI Analysis Engine</p>
                                <p class="text-sm text-gray-600">Learning from 30 days of data...</p>
                            </div>
                        </div>

                        <div class="p-4 bg-yellow-50 border-2 border-yellow-300 rounded-xl mb-3">
                            <p class="text-sm font-semibold text-yellow-800 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
                                Pattern Detected
                            </p>
                            <p class="text-xs text-yellow-700 mt-1">AI predicts 80% chance of missed evening dose on Fridays based on historical patterns. Sending early reminder and caregiver notification.</p>
                        </div>

                        <div class="p-4 bg-blue-50 border-2 border-blue-200 rounded-xl mb-3">
                            <p class="text-sm font-semibold text-blue-800 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg>
                                Behavioral Insights
                            </p>
                            <p class="text-xs text-blue-700 mt-1">Morning medications are taken 95% on time. Evening doses show 15% delay. Recommendation: Adjust evening reminder time by 30 minutes earlier.</p>
                        </div>

                        <div class="p-4 bg-green-50 border-2 border-green-300 rounded-xl">
                            <p class="text-sm font-semibold text-green-800 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                                Personalized Strategy
                            </p>
                            <p class="text-xs text-green-700 mt-1">AI has adapted reminder frequency and timing based on patient's unique response patterns, improving adherence by 25% over the past two weeks.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State
        let simulationRunning = false;
        let medicationTaken = false;
        let touchDetected = false;
        let currentCompartment = null;
        let elapsedTime = 0;
        let timerInterval = null;
        let continuousAlarmInterval = null;
        let notificationCounter = 0;
        let soundEnabled = false;

        // Navigation
        function startDemo() {
            document.getElementById('page-home').classList.add('hidden-page');
            document.getElementById('page-demo').classList.remove('hidden-page');
        }

        function backToHome() {
            stopSimulation();
            document.getElementById('page-demo').classList.add('hidden-page');
            document.getElementById('page-home').classList.remove('hidden-page');
        }

        // Audio Functions
        function playBeep() {
            if (!soundEnabled) {
                soundEnabled = true; // Auto-enable on first interaction
            }
            
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'square';
                gainNode.gain.value = 0.3;
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.2);
                
                console.log("🔊 BEEP!");
            } catch (error) {
                console.error("Sound error:", error);
            }
        }

        function speak(text) {
            if ('speechSynthesis' in window && soundEnabled) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                utterance.pitch = 1.0;
                speechSynthesis.speak(utterance);
            }
        }

        // Notification Functions
        function addNotification(message, type = 'info') {
            const container = document.getElementById('phone-notifications');
            
            // Clear placeholder if exists
            if (container.querySelector('.text-center')) {
                container.innerHTML = '';
            }

            const notification = document.createElement('div');
            notification.className = 'notification-enter mb-3 p-4 rounded-xl border-2 ' + getNotificationStyle(type);
            
            const icon = getNotificationIcon(type);
            const time = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
            
            notification.innerHTML = `
                <div class="flex items-start gap-3">
                    <div class="flex-shrink-0 p-2 bg-white rounded-full">
                        ${icon}
                    </div>
                    <div class="flex-1">
                        <p class="text-sm font-semibold text-gray-800 mb-1">${message}</p>
                        <div class="text-xs text-gray-500">Smart Medication Box • ${time}</div>
                    </div>
                </div>
            `;
            
            container.insertBefore(notification, container.firstChild);
            container.scrollTop = 0;

            // Show urgent badge
            if (type === 'urgent' || type === 'emergency') {
                document.getElementById('urgent-badge').classList.remove('hidden');
            }
        }

        function getNotificationStyle(type) {
            switch(type) {
                case 'info': return 'bg-blue-50 border-blue-200';
                case 'alert': return 'bg-yellow-50 border-yellow-300';
                case 'warning': return 'bg-orange-50 border-orange-300';
                case 'urgent': return 'bg-red-50 border-red-300';
                case 'emergency': return 'bg-red-100 border-red-400';
                case 'success': return 'bg-green-50 border-green-300';
                default: return 'bg-gray-50 border-gray-200';
            }
        }

        function getNotificationIcon(type) {
            const iconClass = "w-5 h-5";
            switch(type) {
                case 'info':
                    return `<svg class="${iconClass} text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`;
                case 'alert':
                case 'warning':
                    return `<svg class="${iconClass} text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>`;
                case 'urgent':
                case 'emergency':
                    return `<svg class="${iconClass} text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`;
                case 'success':
                    return `<svg class="${iconClass} text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`;
                default:
                    return `<svg class="${iconClass} text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/></svg>`;
            }
        }

        // Simulation Functions
        function startSimulation() {
            if (simulationRunning) return;

            const timeSelect = document.getElementById('time-select');
            const selectedTime = timeSelect.value;
            
            // Determine compartment
            if (selectedTime === '08:00') {
                currentCompartment = 'morning';
            } else if (selectedTime === '14:00') {
                currentCompartment = 'afternoon';
            } else {
                currentCompartment = 'evening';
            }

            // Reset state
            simulationRunning = true;
            medicationTaken = false;
            touchDetected = false;
            elapsedTime = 0;
            document.getElementById('urgent-badge').classList.add('hidden');

            // Show and reset timer - FORCE DISPLAY
            const timerDisplay = document.getElementById('timer-display');
            timerDisplay.classList.remove('hidden');
            timerDisplay.style.display = 'block';
            document.getElementById('timer-seconds').textContent = '0';
            document.getElementById('timer-status').innerHTML = '<p class="text-gray-600 text-xs">⏰ Next: 20s</p>';
            
            console.log("⏱️ Timer display shown!");

            // Reset UI
            resetCompartments();
            document.getElementById('touch-status').textContent = 'Waiting for touch...';
            document.getElementById('touch-status').classList.remove('text-green-600', 'font-semibold');
            document.getElementById('weight-status').textContent = 'Monitoring weight...';
            document.getElementById('weight-status').classList.remove('text-green-600', 'font-semibold');

            // Open compartment
            openCompartment(currentCompartment);

            // Play initial beep
            playBeep();
            speak("It's medicine time, Grandma!");

            // Add initial notification
            const medName = selectedTime === '08:00' ? 'Blood Pressure Medicine' : selectedTime === '14:00' ? 'Diabetes Medicine' : 'Vitamins';
            addNotification(`📱 FAMILY: Medication time - ${medName} at ${selectedTime}`, 'info');

            // Start timer
            timerInterval = setInterval(() => {
                if (!medicationTaken) {
                    elapsedTime++;
                    console.log(`⏱️ Elapsed: ${elapsedTime}s`);

                    // Update floating timer
                    document.getElementById('timer-seconds').textContent = elapsedTime;
                    
                    if (elapsedTime < 20) {
                        document.getElementById('timer-status').innerHTML = '<p class="text-gray-600 text-xs">⏰ Next: 20s</p>';
                    } else if (elapsedTime < 40) {
                        document.getElementById('timer-status').innerHTML = '<p class="text-orange-600 font-semibold text-xs">🔔 Alarm on</p>';
                    } else {
                        document.getElementById('timer-status').innerHTML = '<p class="text-red-600 font-bold text-xs">🚨 ALERT!</p>';
                    }

                    // Notifications at specific times
                    if (elapsedTime === 10) {
                        addNotification('📱 FAMILY: Patient delayed 10 seconds', 'alert');
                    } else if (elapsedTime === 20) {
                        addNotification('📱 FAMILY: Patient delayed 20 seconds - Still not taken!', 'warning');
                        // Start continuous alarm
                        startContinuousAlarm();
                    } else if (elapsedTime === 30) {
                        addNotification('🚨 FAMILY URGENT: 30 seconds delay - Please check immediately!', 'urgent');
                        speak("Emergency! Patient needs help!");
                    } else if (elapsedTime === 40) {
                        addNotification('📱🔊 EMERGENCY: PHONE CALL TO FAMILY!', 'emergency');
                        addNotification('📳 PHONE RINGING & VIBRATING!', 'emergency');
                        addNotification('🚨 CRITICAL: Medicine NOT taken for 40 seconds!', 'emergency');
                        speak("Emergency! Emergency! Critical alert! Medicine not taken! Please help immediately!");
                    }
                }
            }, 1000);
        }

        function startContinuousAlarm() {
            console.log("🔔 Starting continuous alarm every 1 second!");
            
            // Speak once at 20 seconds
            speak("Please Grandma, take your medicine! Please take your medicine now!");
            
            continuousAlarmInterval = setInterval(() => {
                if (!medicationTaken) {
                    playBeep();
                }
            }, 1000);
        }

        function stopSimulation() {
            simulationRunning = false;
            if (timerInterval) clearInterval(timerInterval);
            if (continuousAlarmInterval) clearInterval(continuousAlarmInterval);
            resetCompartments();
            
            // Hide timer
            const timerDisplay = document.getElementById('timer-display');
            timerDisplay.classList.add('hidden');
            timerDisplay.style.display = 'none';
            console.log("⏱️ Timer hidden");
        }

        function touchBox() {
            if (!simulationRunning || touchDetected) return;
            
            touchDetected = true;
            const touchStatus = document.getElementById('touch-status');
            touchStatus.textContent = '✅ Touch detected!';
            touchStatus.classList.remove('text-gray-500');
            touchStatus.classList.add('text-green-600', 'font-semibold');
            
            playBeep();
            addNotification('📱 FAMILY: Patient has touched the medicine box', 'info');
        }

        function takeMedicine() {
            if (!simulationRunning || medicationTaken) {
                return;
            }
            
            if (!touchDetected) {
                alert('⚠️ Please touch the box first!');
                return;
            }

            medicationTaken = true;
            const weightStatus = document.getElementById('weight-status');
            weightStatus.textContent = '✅ Medicine taken!';
            weightStatus.classList.remove('text-gray-500');
            weightStatus.classList.add('text-green-600', 'font-semibold');

            // Stop all timers
            if (timerInterval) clearInterval(timerInterval);
            if (continuousAlarmInterval) clearInterval(continuousAlarmInterval);

            // Close compartment
            closeCompartment(currentCompartment);

            // Positive feedback
            playBeep();
            
            // Check if it was during emergency (after 40s)
            if (elapsedTime >= 40) {
                speak("Excellent! Medicine taken! Great job Grandma! Family has been notified. Everything is okay now!");
            } else {
                speak("Perfect! Great job Grandma! You took your medicine on time! Well done!");
            }
            
            addNotification('✅ SUCCESS: Medicine taken successfully!', 'success');
            addNotification('📱 FAMILY: ✅ Patient successfully took medicine!', 'success');

            // Hide timer after 2 seconds
            setTimeout(() => {
                simulationRunning = false;
                const timerDisplay = document.getElementById('timer-display');
                timerDisplay.classList.add('hidden');
                timerDisplay.style.display = 'none';
                // Reset for next medication
                elapsedTime = 0;
                document.getElementById('timer-seconds').textContent = '0';
                console.log("⏱️ Timer hidden and reset");
            }, 2000);
        }

        function openCompartment(compartment) {
            const card = document.getElementById(`${compartment}-compartment`);
            const status = document.getElementById(`${compartment}-status`);
            const alert = document.getElementById(`${compartment}-alert`);
            
            card.classList.add('compartment-open');
            status.textContent = 'OPEN';
            status.classList.remove('text-gray-500', 'bg-white');
            status.classList.add('text-green-600', 'bg-green-100');
            
            if (alert) alert.classList.remove('hidden');
        }

        function closeCompartment(compartment) {
            const card = document.getElementById(`${compartment}-compartment`);
            const status = document.getElementById(`${compartment}-status`);
            const alert = document.getElementById(`${compartment}-alert`);
            
            card.classList.remove('compartment-open');
            status.textContent = 'CLOSED';
            status.classList.remove('text-green-600', 'bg-green-100');
            status.classList.add('text-gray-500', 'bg-white');
            
            if (alert) alert.classList.add('hidden');
        }

        function resetCompartments() {
            ['morning', 'afternoon', 'evening'].forEach(comp => {
                closeCompartment(comp);
            });
        }

        // Auto-enable sound on first user interaction
        document.addEventListener('click', () => {
            if (!soundEnabled) {
                soundEnabled = true;
                console.log("🔊 Sound enabled");
            }
        }, { once: true });

        // Toggle Future Enhancement Demos
        function toggleDemo(type) {
            const demo = document.getElementById(`demo-${type}`);
            const btn = document.getElementById(`btn-${type}`);
            
            // Hide all other demos first
            ['biometric', 'ehr', 'ai'].forEach(demoType => {
                if (demoType !== type) {
                    document.getElementById(`demo-${demoType}`).classList.add('hidden');
                    document.getElementById(`btn-${demoType}`).textContent = 'View Demo';
                }
            });
            
            // Toggle current demo
            if (demo.classList.contains('hidden')) {
                demo.classList.remove('hidden');
                btn.textContent = 'Hide Demo';
            } else {
                demo.classList.add('hidden');
                btn.textContent = 'View Demo';
            }
        }

        // Update Blood Pressure from Sliders
        function updateBP() {
            const systolic = parseInt(document.getElementById('systolic-slider').value);
            const diastolic = parseInt(document.getElementById('diastolic-slider').value);
            
            // Update display values
            document.getElementById('systolic-value').textContent = systolic;
            document.getElementById('diastolic-value').textContent = diastolic;
            document.getElementById('current-systolic').textContent = systolic;
            document.getElementById('current-diastolic').textContent = diastolic;
            
            // Update main blood pressure display
            const bpDisplay = document.getElementById('blood-pressure');
            if (bpDisplay) {
                bpDisplay.textContent = `${systolic}/${diastolic}`;
            }
            
            const bpStatus = document.getElementById('bp-status');
            const safeMsg = document.getElementById('bp-safe');
            const dangerMsg = document.getElementById('bp-danger');

            // Determine status
            if (systolic < 140 && diastolic < 90) {
                // Normal
                bpStatus.textContent = '✓ Normal';
                bpStatus.className = 'text-xs text-gray-500 mt-1';
                safeMsg.classList.remove('hidden');
                dangerMsg.classList.add('hidden');
                hideBPEmergencyCall();
            } else if (systolic >= 160 || diastolic >= 100) {
                // High (Dangerous) - TRIGGER EMERGENCY IMMEDIATELY
                bpStatus.textContent = '⚠️ High - Dangerous';
                bpStatus.className = 'text-xs text-red-600 font-bold mt-1';
                safeMsg.classList.add('hidden');
                dangerMsg.classList.remove('hidden');
                
                // SHOW EMERGENCY CALL IMMEDIATELY
                setTimeout(() => {
                    showBPEmergencyCall();
                }, 300);
            } else {
                // Elevated
                bpStatus.textContent = '⚠️ Elevated';
                bpStatus.className = 'text-xs text-orange-600 font-bold mt-1';
                safeMsg.classList.add('hidden');
                dangerMsg.classList.remove('hidden');
                hideBPEmergencyCall();
            }
        }

        // Show Emergency Call Modal for BP
        function showBPEmergencyCall() {
            const modal = document.getElementById('bp-emergency-modal');
            if (modal) {
                modal.classList.remove('hidden');
                modal.style.display = 'flex';
                playBeep();
                speak("Emergency! High blood pressure detected! Calling family member immediately!");
                console.log("🚨 EMERGENCY CALL TRIGGERED!");
            }
        }

        // Hide Emergency Call Modal for BP
        function hideBPEmergencyCall() {
            const modal = document.getElementById('bp-emergency-modal');
            if (modal) {
                modal.classList.add('hidden');
                modal.style.display = 'none';
            }
        }

        // Answer the call - show connected screen
        function answerCall() {
            // Hide calling screen
            hideBPEmergencyCall();
            
            // Show connected screen
            const connectedModal = document.getElementById('bp-connected-modal');
            if (connectedModal) {
                connectedModal.classList.remove('hidden');
                connectedModal.style.display = 'flex';
                
                // Cancel previous speech
                if (window.speechSynthesis) {
                    window.speechSynthesis.cancel();
                }
                
                // Speak connected message
                setTimeout(() => {
                    playBeep();
                    speak("Call connected. Family member on the line. Patient needs immediate attention due to high blood pressure.");
                }, 500);
                
                console.log("✅ Call answered and connected!");
            }
        }

        // End Call and return to home page
        function endCallToHome() {
            // Hide connected modal
            const connectedModal = document.getElementById('bp-connected-modal');
            if (connectedModal) {
                connectedModal.classList.add('hidden');
                connectedModal.style.display = 'none';
            }
            
            // Cancel speech
            if (window.speechSynthesis) {
                window.speechSynthesis.cancel();
            }
            
            // Go back to home page
            backToHome();
            
            console.log("📞 Call ended, returned to home");
        }

        // End Call (from calling screen)
        function endCall() {
            hideBPEmergencyCall();
            const connectedModal = document.getElementById('bp-connected-modal');
            if (connectedModal) {
                connectedModal.classList.add('hidden');
                connectedModal.style.display = 'none';
            }
            if (window.speechSynthesis) {
                window.speechSynthesis.cancel();
            }
            console.log("📞 Call ended");
        }
    </script>

    <!-- BP Emergency Call Modal - Stage 1: Calling - Mobile Responsive -->
    <div id="bp-emergency-modal" class="hidden" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6); z-index: 9999; align-items: center; justify-content: center; padding: 16px;">
        <div class="modal-content bg-white rounded-2xl md:rounded-3xl p-6 md:p-8 max-w-md w-full shadow-2xl" style="animation: slideIn 0.3s ease-out;">
            <div class="text-center">
                <div class="w-16 h-16 md:w-20 md:h-20 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4" style="animation: pulse 1.5s infinite;">
                    <svg class="w-10 h-10 md:w-12 md:h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                    </svg>
                </div>
                <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2 md:mb-3">📞 EMERGENCY CALL</h3>
                <p class="text-base md:text-lg text-gray-600 mb-4 md:mb-6">Calling family member immediately...</p>
                <button onclick="answerCall()" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 md:py-4 px-6 rounded-full font-bold text-base md:text-lg transition-colors flex items-center justify-center gap-2 mx-auto shadow-lg">
                    <svg class="w-5 h-5 md:w-6 md:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                    </svg>
                    Answer Call
                </button>
            </div>
        </div>
    </div>

    <!-- BP Emergency Call Modal - Stage 2: Connected - Mobile Responsive -->
    <div id="bp-connected-modal" class="hidden" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6); z-index: 9999; align-items: center; justify-content: center; padding: 16px;">
        <div class="modal-content bg-white rounded-2xl md:rounded-3xl p-6 md:p-8 max-w-md w-full shadow-2xl" style="animation: slideIn 0.3s ease-out;">
            <div class="text-center">
                <div class="w-16 h-16 md:w-20 md:h-20 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4">
                    <svg class="w-10 h-10 md:w-12 md:h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                    </svg>
                </div>
                <div class="flex items-center justify-center gap-2 mb-2 md:mb-3">
                    <svg class="w-6 h-6 md:w-7 md:h-7 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    <h3 class="text-2xl md:text-3xl font-bold text-gray-800">Call Connected</h3>
                </div>
                <p class="text-base md:text-lg text-gray-700 mb-1 md:mb-2 font-semibold">Family member on the line.</p>
                <p class="text-sm md:text-base text-gray-600 mb-4 md:mb-6">Patient needs attention.</p>
                <button onclick="endCallToHome()" class="w-full bg-red-500 hover:bg-red-600 text-white py-3 md:py-4 px-6 rounded-full font-bold text-base md:text-lg transition-colors flex items-center justify-center gap-2 mx-auto shadow-lg">
                    <svg class="w-5 h-5 md:w-6 md:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                    End Call
                </button>
            </div>
        </div>
    </div>

    <!-- Timer Display (Floating) - Mobile Responsive -->
    <div id="timer-display" class="hidden" style="display: none;">
        <div class="text-center">
            <p class="text-xs md:text-sm font-semibold text-gray-600 mb-1">⏱️ Time</p>
            <p class="text-3xl md:text-5xl font-bold text-blue-600" id="timer-seconds">0</p>
            <p class="text-xs text-gray-500 mt-1">sec</p>
            <div class="mt-2 text-xs" id="timer-status">
                <p class="text-gray-600 text-xs">⏰ Next: 20s</p>
            </div>
        </div>
    </div>
</body>
</html>